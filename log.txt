Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: tensorboardX in /usr/local/lib/python3.7/dist-packages (2.5.1)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from tensorboardX) (1.21.6)
Requirement already satisfied: protobuf<=3.20.1,>=3.8.0 in /usr/local/lib/python3.7/dist-packages (from tensorboardX) (3.17.3)
Requirement already satisfied: six>=1.9 in /usr/local/lib/python3.7/dist-packages (from protobuf<=3.20.1,>=3.8.0->tensorboardX) (1.15.0)
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: gpustat in /usr/local/lib/python3.7/dist-packages (0.6.0)
Requirement already satisfied: nvidia-ml-py3>=7.352.0 in /usr/local/lib/python3.7/dist-packages (from gpustat) (7.352.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.7/dist-packages (from gpustat) (5.4.8)
Requirement already satisfied: six>=1.7 in /usr/local/lib/python3.7/dist-packages (from gpustat) (1.15.0)
Requirement already satisfied: blessings>=1.6 in /usr/local/lib/python3.7/dist-packages (from gpustat) (1.7)
2022-06-26 15:46:17 running arguments: Namespace(batch_size=128, bit_width_list='4,4,4,4,4', dataset='cifar10', epochs=200, lr=0.001, lr_decay='100,150,180', model='resnet20q', optimizer='adam', pretrain=None, print_freq=20, results_dir='/content/drive/MyDrive/Any-Precision-DNNs/results/exp_cifar10_resnet20q_124832_recursive_20220626_154616', resume=None, start_epoch=0, train_split='train', weight_decay=0.0, workers=0)
Files already downloaded and verified
Files already downloaded and verified
2022-06-26 15:46:25 number of parameters: 6758810
2022-06-26 15:46:25 inp_qtensor.tensor.shape
2022-06-26 15:46:25 torch.Size([128, 3, 32, 32])
2022-06-26 15:46:25 wgt_qtensor.tensor.shape
2022-06-26 15:46:25 torch.Size([80, 3, 3, 3])
2022-06-26 15:46:25 inp.shape
2022-06-26 15:46:25 torch.Size([128, 3, 32, 32])
2022-06-26 15:46:25 wgt.shape
2022-06-26 15:46:25 torch.Size([80, 3, 3, 3])
Traceback (most recent call last):
  File "/content/drive/MyDrive/Any-Precision-DNNs/train.py", line 222, in <module>
    main()
  File "/content/drive/MyDrive/Any-Precision-DNNs/train.py", line 110, in main
    optimizer, sum_writer)
  File "/content/drive/MyDrive/Any-Precision-DNNs/train.py", line 185, in forward
    output = model(input)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/content/drive/MyDrive/Any-Precision-DNNs/models/resnet_quan.py", line 110, in forward
    out = self.conv0(x)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/content/drive/MyDrive/Any-Precision-DNNs/models/quan_ops.py", line 309, in forward
    self.dilation, self.groups)
  File "/content/drive/MyDrive/Any-Precision-DNNs/models/quan_ops.py", line 274, in myconv2d_lut
    inp_qtensor_unf = unfold_qtensor(inp_qtensor.tensor)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/fold.py", line 295, in forward
    self.padding, self.stride)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py", line 4674, in unfold
    if input.dim() == 4:
AttributeError: 'QTensor' object has no attribute 'dim'